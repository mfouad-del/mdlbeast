# .htaccess for the /archive static export folder
# - Avoid rewrites for static/_next assets
# - Set CORS headers for fonts and common static assets
# - Prevent directory listing

DirectoryIndex index.html

<IfModule mod_rewrite.c>
  RewriteEngine On

  # If a request comes to /_next or /static at the site root, internally rewrite it to /archive
  # This allows requests like https://zaco.sa/_next/... to be served from /archive/_next/...
  RewriteCond %{REQUEST_URI} ^/_next/ [OR]
  RewriteCond %{REQUEST_URI} ^/static/ [OR]
  RewriteCond %{REQUEST_URI} \.(css|js|png|jpg|jpeg|gif|svg|woff2|woff|ttf|otf|eot|ico)$ [NC]
  RewriteRule ^(.*)$ /archive/$1 [L]

  # DO NOT rewrite already-correct archive _next/static requests
  RewriteCond %{REQUEST_URI} ^/archive/_next/ [OR]
  RewriteCond %{REQUEST_URI} ^/archive/static/ [OR]
  RewriteCond %{REQUEST_URI} \.(css|js|png|jpg|jpeg|gif|svg|woff2|woff|ttf|otf|eot|ico)$ [NC]
  RewriteRule .* - [L]
</IfModule>

# Note: removed mod_headers directives to avoid 500s on shared hosts.
# If your host allows setting headers, configure them at the host control panel or server config.

# Prevent directory listing
<IfModule mod_autoindex.c>
  Options -Indexes
</IfModule>
